# Enable rewriting
RewriteEngine On

# Set base directory
RewriteBase /

# If the request is for an actual file or directory that exists in the root, serve it directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Otherwise, rewrite all requests to the public directory
# But don't show "public" in the URL
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /public/([^\ ]*)\ HTTP/
RewriteRule ^public/(.*)$ /$1 [R=301,L]

# Internally rewrite requests to the public directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ public/$1 [L]

# Handle the case where someone requests the root
RewriteRule ^$ public/index.html [L]